**ss** — консольная утилита, которая предоставляет информацию о сетевых сокетах, подключениях **TCP/UDP**, маршрутизации и других сетевых статистических данных.

**ss** отображает информацию аналогично утилите **netstat** и при этом выводит больше информации о сетевых соединениях и их состоянии, чем какие-либо другие инструменты.

Информация о сокете выводится в виде таблицы. Каждый столбец отображает определенную информацию, относящуюся к сокету.

## Примеры использования утилиты

Для отображения всех TCP-соединений

\# ss -at

Для отображения всех UDP-соединений

\# ss -au

Для вывода информации о подключенных TCP- и UDP-сокетах, а также использующих подключения процессах (name, pid)

\# ss -tup

Для отображения открытых TCP- и UDP-сокетов, которые ожидают соединение (LISTEN) — добавляем опцию опцию `-l`

\# ss -tupl

## Основные опции

- `-V, --version` — показать версию утилиты
- `-n, --numeric` — не определять имена служб
- `-r, --resolve` — определять сетевые имена адресов
- `-a, --all` — отобразить все сокеты (открытые соединения)
- `-l, --listening` — показать только прослушиваемые сокеты
- `-o, --options` — показать информацию таймера
- `-e, --extended` — выводить расширенную информацию о сокете
- `-p, --processes` — показать процессы, использующие сокет
- `-i, --info` — посмотреть внутреннюю информацию TCP
- `-s, --summary` — статистика использования сокета
-  - x,  - только unix socket
-  **state established** — показать соединения только для определённого состояния;
- **src 192.168.0.14** — показать соединения только на определённый ip-адрес сервера;
- **dst 192.168.0.14** — показать соединения только с определённым ip-адресом второй стороны;
- **src :22** — соединения только с локальным 22 портом, можете выбрать любой другой порт;
- **‘( dport = :ssh or sport = :ssh )’** — совмещение разных опций.

Можно выводить информацию о сокете, который использует только необходимый протокол

- `-4, --ipv4` — только сокеты протокола IPv4
- `-6, --ipv6` — только сокеты протокола IPv6
- `-0, --packet` — только PACKET-сокеты
- `-t, --tcp` — только TCP-сокеты
- `-u, --udp` — только UDP-сокеты
- `-x, --unix` — только UNIX-сокеты

Описание выводимой информации в столбцах:

- `Netid` - тип подключения: отображает тип сокета;

	- **u_dgr** — тип сокета, который работает без установки соединения;
	- **u_str** — тип сокета, который работает с предварительной установкой соединения;
	- **tcp — tcp** соединение;
	- **udp — udp** соединение.
    
- `State` — отображает состояние сокета. Может принимать следующие значения: сокет установлен — **ESTAB**, сокет не подключен — **UNCONN**, сокет прослушивается — **LISTEN**.
    
- `Recv-Q` — отображает количество принятых пакетов в очереди;
    
- `Send-Q` — отображает количество отправленных пакетов в очереди;
    
- `Local address:port` — показывает адрес локальной машины и порт;
    
- `Peer address:port` — отображает адрес удаленной машины и порт.
    
## Использование утилиты ss

Синтаксис утилиты **ss** выглядит следующим образом:

ss <опции>

Утилита ss может принимать несколько опций:

ss <опция_1> <опция_2> <опция_3> …

Основные опции утилиты **ss**:

- `-V, --version` — показать версию утилиты;
    
- `-n, --numeric` — не определять имена служб;
    
- `-r, --resolve` — определять сетевые имена адресов с помощью DNS;
    
- `-a, --all` — отобразить все сокеты (открытые соединения);
    
- `-l, --listening` — показать только прослушиваемые сокеты;
    
- `-o, --options` — показать информацию таймера;
    
- `-e, --extended` — выводить расширенную информацию о сокете;
    
- `-p, --processes` — показать процессы, использующие сокет;
    
- `-i, --info` — посмотреть внутреннюю информацию TCP;
    
- `-s, --summary` — статистика использования сокета;
    
- `-``D, --diag=<файл>` — экспортировать текущее состояние TCP-сокетов в файл;
    
- `-F, --filter=<файл>` — работать с информацией, взятой из файла.
    

Можно выводить информацию о сокете, который использует только необходимый протокол, используя следующие опции:

- `-4, --ipv4` — только сокеты протокола IPv4;
    
- `-6, --ipv6` — только сокеты протокола IPv6;
    
- `-0, --packet` — только PACKET-сокеты;
    
- `-t, --tcp` — TCP-сокеты;
    
- `-u, --udp` — UDP-сокеты;
    
- `-x, --unix` — UNIX-сокеты.
    

Для отображения всех TCP-соединений выполните команду:

ss -ta

Для отображения всех UDP-соединений выполните команду:

ss -ua

Для вывода информации о подключенных TCP- и UDP-сокетах, а также информации о процессах, которые используют сокеты — имя процесса и его PID, выполните:

ss -tupn

Для отображения открытых TCP- и UDP-сокетов, которые ожидают соединение, выполните команду, добавив опцию -l:

ss -tupnl

## Вывод информации по IP-адресу

Утилита поддерживает фильтрацию информации об установленных подключениях по адресу назначения и по адресу получения.

Для фильтрации информации по адресу назначения выполните:

ss dst xx.xx.xx.xx

Для фильтрации информации по адресу получения выполните:

ss src xx.xx.xx.xx

где xx.xx.xx.xx — IP-адрес, по которому необходимо отфильтровать информацию.

## Вывод информации по состоянию сокета

Можно отфильтровать информацию по состоянию сокета. Для этого используется дополнительный ключ `state`.

Состояния, которые может принимать сокет:

- _established_;
    
- _listening_;
    
- _syn-sent_;
    
- _syn-recv_;
    
- _time-wait_;
    
- _closed_;
    
- _close-wait_;
    
- _last-ack_;
    
- _fin-wait-1_;
    
- _fin-wait-2_;
    
- _closing_.
    

Кроме того, ss распознаёт следующие идентификаторы состояний:

- _all_ — все состояния;
    
- _connected_ — все состояния, кроме прослушиваемых и закрытых;
    
- _synchronized_ — все состояния, кроме _syn-sent_;
    
- _bucket_ — состояния, представляющие собой минисокеты, например, _time-wait_ или _syn-recv_;
    
- _big_ — все состояния, кроме _bucket_.
    

Для отображения всех открытых TCP-портов выполните команду:

ss -t state listening

Для отображения всех успешных соединений по IPv4 выполните:

ss -4 state established

## Вывод информации по имени сервиса или номеру порта

Для фильтрации информации по номеру порта или его имени утилите необходимо передать соответствующие опции:

- для порта получения:

ss <опции> sport = :<порт>

- для порта назначения:

ss <опции> dport = :<порт>

   где <порт> — номер порта или имя сервиса.

Для фильтрации TCP-соединения с выводом информации об использовании только порта получателя **22** выполните:

ss -ta '( sport = :**22** )'

Для фильтрации TCP-соединения с выводом информации об использовании сервиса **HTTPS** в адресе назначения выполните:

ss -ta '( dport = :**https** )'